{"ast":null,"code":"'use strict'; // hoisted due to circular dependency on command.\n\nmodule.exports = {\n  applyMiddleware,\n  commandMiddlewareFactory,\n  globalMiddlewareFactory\n};\n\nconst isPromise = require('./is-promise');\n\nconst argsert = require('./argsert');\n\nfunction globalMiddlewareFactory(globalMiddleware, context) {\n  return function (callback, applyBeforeValidation = false) {\n    argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length);\n\n    if (Array.isArray(callback)) {\n      for (let i = 0; i < callback.length; i++) {\n        if (typeof callback[i] !== 'function') {\n          throw Error('middleware must be a function');\n        }\n\n        callback[i].applyBeforeValidation = applyBeforeValidation;\n      }\n\n      Array.prototype.push.apply(globalMiddleware, callback);\n    } else if (typeof callback === 'function') {\n      callback.applyBeforeValidation = applyBeforeValidation;\n      globalMiddleware.push(callback);\n    }\n\n    return context;\n  };\n}\n\nfunction commandMiddlewareFactory(commandMiddleware) {\n  if (!commandMiddleware) return [];\n  return commandMiddleware.map(middleware => {\n    middleware.applyBeforeValidation = false;\n    return middleware;\n  });\n}\n\nfunction applyMiddleware(argv, yargs, middlewares, beforeValidation) {\n  const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true');\n  return middlewares.reduce((accumulation, middleware) => {\n    if (middleware.applyBeforeValidation !== beforeValidation && !isPromise(accumulation)) {\n      return accumulation;\n    }\n\n    if (isPromise(accumulation)) {\n      return accumulation.then(initialObj => Promise.all([initialObj, middleware(initialObj, yargs)])).then(([initialObj, middlewareObj]) => Object.assign(initialObj, middlewareObj));\n    } else {\n      const result = middleware(argv, yargs);\n      if (beforeValidation && isPromise(result)) throw beforeValidationError;\n      return isPromise(result) ? result.then(middlewareObj => Object.assign(accumulation, middlewareObj)) : Object.assign(accumulation, result);\n    }\n  }, argv);\n}","map":{"version":3,"sources":["/Users/sidneyjackson/Desktop/GitHub Projects/UnitedCoders/clueless_react/node_modules/yargs/lib/middleware.js"],"names":["module","exports","applyMiddleware","commandMiddlewareFactory","globalMiddlewareFactory","isPromise","require","argsert","globalMiddleware","context","callback","applyBeforeValidation","arguments","length","Array","isArray","i","Error","prototype","push","apply","commandMiddleware","map","middleware","argv","yargs","middlewares","beforeValidation","beforeValidationError","reduce","accumulation","then","initialObj","Promise","all","middlewareObj","Object","assign","result"],"mappings":"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","sourcesContent":["'use strict'\n\n// hoisted due to circular dependency on command.\nmodule.exports = {\n  applyMiddleware,\n  commandMiddlewareFactory,\n  globalMiddlewareFactory\n}\nconst isPromise = require('./is-promise')\nconst argsert = require('./argsert')\n\nfunction globalMiddlewareFactory (globalMiddleware, context) {\n  return function (callback, applyBeforeValidation = false) {\n    argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length)\n    if (Array.isArray(callback)) {\n      for (let i = 0; i < callback.length; i++) {\n        if (typeof callback[i] !== 'function') {\n          throw Error('middleware must be a function')\n        }\n        callback[i].applyBeforeValidation = applyBeforeValidation\n      }\n      Array.prototype.push.apply(globalMiddleware, callback)\n    } else if (typeof callback === 'function') {\n      callback.applyBeforeValidation = applyBeforeValidation\n      globalMiddleware.push(callback)\n    }\n    return context\n  }\n}\n\nfunction commandMiddlewareFactory (commandMiddleware) {\n  if (!commandMiddleware) return []\n  return commandMiddleware.map(middleware => {\n    middleware.applyBeforeValidation = false\n    return middleware\n  })\n}\n\nfunction applyMiddleware (argv, yargs, middlewares, beforeValidation) {\n  const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true')\n  return middlewares\n    .reduce((accumulation, middleware) => {\n      if (middleware.applyBeforeValidation !== beforeValidation &&\n          !isPromise(accumulation)) {\n        return accumulation\n      }\n\n      if (isPromise(accumulation)) {\n        return accumulation\n          .then(initialObj =>\n            Promise.all([initialObj, middleware(initialObj, yargs)])\n          )\n          .then(([initialObj, middlewareObj]) =>\n            Object.assign(initialObj, middlewareObj)\n          )\n      } else {\n        const result = middleware(argv, yargs)\n        if (beforeValidation && isPromise(result)) throw beforeValidationError\n\n        return isPromise(result)\n          ? result.then(middlewareObj => Object.assign(accumulation, middlewareObj))\n          : Object.assign(accumulation, result)\n      }\n    }, argv)\n}\n"]},"metadata":{},"sourceType":"script"}